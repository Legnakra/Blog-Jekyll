<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>

  <title>Talleres DNS</title>
  <meta name='description' content="Talleres DNSTaller 1: Instalación y configuración del servidor bind9 en nuestra red local.  Creamos una máquina en Proxmox configurada con cloud init e insta...">
  <link rel='canonical' href="flexton.netlify.com/2022/12/12/talleres-dns/">
  <link rel='alternate' type='application/rss+xml' title='Welcome to MariaTec' href="flexton.netlify.com/feed.xml">
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Volkhov:400,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet">

  <style>
    
    /*! normalize.css v7.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:rgba(0,0,0,0);-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,html [type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,p,blockquote,pre,dl,dd,ol,ul,fieldset,legend,figure,hr{margin:0;padding:0}li>ul,li>ol{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}@-webkit-keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.icon{position:relative;display:inline-block;width:25px;height:25px;overflow:hidden;fill:currentColor}.icon__cnt{width:100%;height:100%;background:inherit;fill:inherit;pointer-events:none;transform:translateX(0);-ms-transform:translate(0.5px, -0.3px)}.icon--m{width:50px;height:50px}.icon--l{width:100px;height:100px}.icon--xl{width:150px;height:150px}.icon--xxl{width:200px;height:200px}.icon__spinner{position:absolute;top:0;left:0;width:100%;height:100%}.icon--ei-spinner .icon__spinner,.icon--ei-spinner-2 .icon__spinner{-webkit-animation:spin 1s steps(12) infinite;animation:spin 1s steps(12) infinite}.icon--ei-spinner-3 .icon__spinner{-webkit-animation:spin 1.5s linear infinite;animation:spin 1.5s linear infinite}.icon--ei-sc-facebook{fill:#3b5998}.icon--ei-sc-github{fill:#333}.icon--ei-sc-google-plus{fill:#dd4b39}.icon--ei-sc-instagram{fill:#3f729b}.icon--ei-sc-linkedin{fill:#0976b4}.icon--ei-sc-odnoklassniki{fill:#ed812b}.icon--ei-sc-skype{fill:#00aff0}.icon--ei-sc-soundcloud{fill:#f80}.icon--ei-sc-tumblr{fill:#35465c}.icon--ei-sc-twitter{fill:#55acee}.icon--ei-sc-vimeo{fill:#1ab7ea}.icon--ei-sc-vk{fill:#45668e}.icon--ei-sc-youtube{fill:#e52d27}.icon--ei-sc-pinterest{fill:#bd081c}.icon--ei-sc-telegram{fill:#08c}*,*::after,*::before{box-sizing:border-box}h1,h2,h3,h4,h5,h6,ul,ol,dl,blockquote,p,address,hr,table,fieldset,figure,pre{margin-bottom:15px}ul,ol,dd{margin-left:15px}.highlight{background:#f7f7f7}.highlighter-rouge .highlight{background:#eef}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:teal}.highlight .nb{color:#0086b3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:teal}.highlight .ni{color:purple}.highlight .ne{color:#900;font-weight:bold}.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:navy}.highlight .nv{color:teal}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:teal}.highlight .vg{color:teal}.highlight .vi{color:teal}.highlight .il{color:#099}body{font-family:"Open Sans",Helvetica Neue,Helvetica,Arial,sans-serif;font-size:15px;line-height:28px;color:#404040;background-color:#fbfbfb;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*::selection{color:#fff;background-color:#3af}h1,h2,h3,h4,h5,h6{font-family:"Volkhov","Times New Roman",Times,serif;font-weight:400;line-height:initial}h1{font-size:32px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}img{max-width:100%;height:auto;vertical-align:middle}a{text-decoration:none;color:#3af;transition:.35s}a:hover{color:#0086e6}blockquote{padding-left:15px;border-left:3px solid #3af;font-family:"Volkhov","Times New Roman",Times,serif;font-style:normal;font-size:18px;background-color:rgba(220,235,245,.2)}blockquote p{padding:10px}hr{height:1px;margin:30px 0;border:0;background-color:#f0f0f0}pre{overflow:auto;padding:25px;font-size:14px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all;font-family:Courier,monospace}code{overflow:auto;white-space:pre-wrap;word-wrap:break-word;word-break:break-all;font-family:Courier,monospace;font-size:14px;background-color:#f7f7f7}p code,li code{padding:3px 5px}.o-wrapper{max-width:1440px;position:relative}.o-opacity{animation-duration:.7s;animation-delay:.2s;animation-fill-mode:both;animation-name:opacity}@keyframes opacity{from{opacity:0}to{opacity:1}}.c-btn{display:inline-block;white-space:nowrap;vertical-align:middle;font-family:"Volkhov",serif;font-size:12px;text-align:center;padding:8px 15px;cursor:pointer;transition:.35s}.c-btn--primary{color:#fff;background-color:#3af;background:linear-gradient(135deg, #33aaff 0%, #62d5ff 100%)}.c-btn--secondary{color:#fff;background-color:#cfcfdd;background:linear-gradient(135deg, #a2a2bd 0%, #cfcfdd 100%)}.c-btn--round{border-radius:30px}.c-btn--shadow{box-shadow:8px 10px 20px 0 rgba(46,61,73,.15)}.c-btn--shadow:hover{box-shadow:2px 4px 8px 0px rgba(46,61,73,.2)}.c-btn--middle{display:block;width:300px;max-width:100%}.c-btn--big{display:block;width:100%}.c-btn:hover{color:#fff;transition:.35s}.c-btn:active{transform:translateY(2px)}.c-sidebar{display:flex;flex-direction:column;justify-content:space-between;position:fixed;top:0;left:0;bottom:0;width:360px;padding:40px 20px 20px;text-align:center;box-shadow:1px 1px 0 rgba(31,35,46,.15);background-color:#fff}.c-sidebar-author .c-author__cover{width:100px;height:100px;margin:0 auto 10px;border-radius:50%;overflow:hidden;background-color:#cfcfdd}.c-sidebar-author .c-author__cover img{width:100%;height:100%;border-radius:50%;transition:.35s}.c-sidebar-author .c-author__cover img:hover{transform:scale3d(0.9, 0.9, 1)}.c-sidebar-author .c-contact-menu .c-btn{min-width:110px}.c-sidebar-author .c-contact-menu .c-btn .icon{width:18px;height:18px;vertical-align:text-bottom;fill:#fff}.c-sidebar-author .c-author__info{font-family:"Volkhov",serif}.c-sidebar-author .c-author__name{font-size:18px;font-weight:700;line-height:21px}.c-sidebar-author .c-author__job{font-size:12px;color:#a0a0a0;margin:5px 0 0}.c-sidebar-author .c-contact-menu{margin:30px 0}.c-sidebar-author .c-contact-menu .c-btn--secondary{margin-right:10px}.c-sidebar-author .c-author__about{max-width:400px;margin:0 auto 15px;font-size:13px}.c-sidebar-footer .c-social__title{position:relative;font-family:"Volkhov",serif;font-size:15px;font-weight:700;color:#444}.c-sidebar-footer .c-social__title::before{content:"";display:block;height:2px;width:calc(50% - 40px);transform:translateY(-50%);position:absolute;top:50%;left:0;background-color:#444}.c-sidebar-footer .c-social__title::after{content:"";display:block;height:2px;width:calc(50% - 40px);transform:translateY(-50%);position:absolute;top:50%;right:0;background-color:#444}.c-sidebar-footer .c-social__list{list-style-type:none;padding:0;margin:15px 0}.c-sidebar-footer .c-social__list .c-social__item{display:inline-block;width:27px;height:27px}.c-sidebar-footer .c-social__list .icon{width:27px;height:27px;fill:#444;vertical-align:middle;transition:.35s}.c-sidebar-footer .c-social__list .icon:hover{fill:#3af;transform:scale(1.2);transition:.35s}.c-sidebar-footer .c-copyright p{font-size:13px;margin:0}@media only screen and (max-width: 900px){.c-sidebar{position:relative;width:100%;padding:20px}.c-sidebar .c-contact-menu{margin:20px 0}.c-sidebar-footer .c-social .c-social__title{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}.c-sidebar-footer .c-social__list{margin:0}.c-sidebar-footer .c-copyright{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}}@media only screen and (max-width: 480px){.c-sidebar-author .c-author__cover{width:80px;height:80px}.c-sidebar-author .c-author__cover img{width:100%;height:100%}.c-sidebar-author .c-contact-menu{margin:15px 0}.c-sidebar-author .c-contact-menu .c-btn{min-width:80px;font-size:10px;padding:4px 15px;margin-right:5px}.c-sidebar-author .c-contact-menu .c-btn .icon{width:16px;height:16px}.c-sidebar-footer .c-social .c-social__title{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}.c-sidebar-footer .c-social__list{margin:0}.c-sidebar-footer .c-social__list .icon{width:25px;height:25px}.c-sidebar-footer .c-copyright{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}}.c-content{position:relative;display:flex;flex-direction:row;flex-wrap:wrap;align-items:stretch;padding:0 20px 0;margin-left:360px}@media only screen and (max-width: 900px){.c-content{position:static;padding:0 15px 0;margin-left:0}}.c-posts{width:100%;display:flex;flex-direction:row;flex-wrap:wrap}.c-post{width:100%;max-width:100%;margin-bottom:20px;display:flex;flex-direction:row;align-items:stretch;min-height:180px;border-radius:10px;overflow:hidden;transition:.35s;background-color:#fff;box-shadow:0 1px 1px 0 rgba(31,35,46,.15)}.c-post:hover{transform:translate(0px, -2px);box-shadow:0 15px 45px -10px rgba(10,16,34,.2)}.c-post .c-post-thumbnail{display:block;width:30%;max-width:100%;min-height:180px;border-radius:10px 0 0 10px;background-color:rgba(220,235,245,.2);background-size:cover;background-position:50% 50%}.c-post .c-post-content{padding:15px;width:70%}.c-post .c-post-content .c-post-title{font-size:30px;font-weight:400;margin:0 0 15px}.c-post .c-post-content .c-post-title a{text-decoration:none;color:#263959}.c-post .c-post-content .c-post-date,.c-post .c-post-content .c-post-words{font-size:12px}.c-load-more{padding:20px;margin:20px auto 40px;font-size:13px;color:#fff;border:none;background-color:#3af;outline:none}.c-load-more:hover{background-color:#0086e6}@media only screen and (max-width: 1200px){.c-post{width:48%;max-width:100%;margin:0 1% 20px;flex-direction:column}.c-post .c-post-thumbnail{width:100%;border-radius:10px 10px 0 0}.c-post .c-post-content{width:100%}.c-post .c-post-content .c-post-title{font-size:21px;margin:15px 0}}@media only screen and (max-width: 480px){.c-post{width:100%;max-width:100%;margin:0 0 20px}.c-post .c-post-content{width:100%}.c-post .c-post-content .c-post-title{font-size:21px;margin:15px 0}}.c-article{width:100%;margin:20px 0}.c-wrap-content{padding:20px;background-color:#fff}.c-article__image{position:relative;background-color:rgba(220,235,245,.2);background-position:center;background-size:cover;background-repeat:no-repeat}.c-article__image:after{content:"";display:block;padding-top:56%}.c-article__header{margin-bottom:20px;text-align:center}.c-article__header .c-article__title{margin-bottom:10px}.c-article__date span{font-size:13px;text-transform:uppercase;color:#a0a0a0}.c-article__footer{margin:30px 0 0;padding-bottom:30px;text-align:center;border-bottom:1px solid #f0f0f0}.c-article__footer .c-article__share{transition:.35s}.c-article__footer .c-article__share a .icon{vertical-align:middle;transition:.35s}.c-article__footer .c-article__share a .icon:hover{opacity:.7;transition:.35s}.c-article__footer .c-article__tag{margin-bottom:5px}.c-article__footer .c-article__tag a{display:inline-block;vertical-align:middle;padding:5px 10px;font-family:"Volkhov","Times New Roman",Times,serif;font-size:10px;line-height:10px;text-transform:uppercase;background-color:rgba(115,138,160,.6);color:#fff}.c-article__footer .c-article__tag a:hover{background-color:rgba(80,100,118,.6)}.c-article__footer .c-article__tag a:last-child{margin-right:0}.c-recent-post{padding:30px 0}.c-recent-post .c-recent__title{font-size:14px;text-align:center;text-transform:uppercase;margin-bottom:30px}.c-recent-post .c-recent__box{display:flex;flex-direction:row;flex-wrap:wrap}.c-recent-post .c-recent__item{max-width:23%;flex-basis:23%;margin:0 1% 20px;border-radius:10px;overflow:hidden;text-align:center;background-color:#fff;box-shadow:0 1px 1px 0 rgba(31,35,46,.15);transition:.35s}.c-recent-post .c-recent__item h4{margin-bottom:5px;font-size:12px;text-transform:uppercase}.c-recent-post .c-recent__item h4 a{color:#444}.c-recent-post .c-recent__item:hover{box-shadow:2px 4px 8px 0px rgba(46,61,73,.2)}.c-recent-post .c-recent__footer{padding:15px}.c-recent-post .c-recent__image{display:block;width:100%;min-height:180px;background-color:rgba(220,235,245,.2);background-size:cover;background-position:center;background-repeat:no-repeat}.c-recent-post .c-recent__date{color:#a0a0a0;font-size:12px}@media only screen and (max-width: 1200px){.c-recent-post .c-recent__item{max-width:48%;flex-basis:48%}}@media only screen and (max-width: 900px){.c-article{margin:15px 0}}@media only screen and (max-width: 480px){.c-wrap-content{padding:15px}.c-article__header{margin-bottom:5px}.c-article__header .c-article__title{font-size:24px;margin-bottom:5px}.c-recent-post .c-recent__item{max-width:100%;flex-basis:100%;margin:0 0 20px}}.c-blog-tags{width:100%;padding:20px;margin:20px 0 40px;background-color:#fff}.c-blog-tags h1{text-align:center;margin-bottom:0}.c-blog-tags h2{font-size:18px;text-transform:uppercase;margin:30px 0;color:#757575}.c-tag__list{list-style:none;padding:0 0 40px;margin:40px 0 0;border-bottom:1px solid #f0f0f0}.c-tag__list li{display:inline-block;margin-right:15px}.c-tag__list li a{color:#404040;text-transform:uppercase;font-size:12px}.c-tag__list li a:hover{color:#000}.c-tag__item{margin-bottom:15px}.c-tag__image{width:50px;height:50px;border-radius:50%;margin-right:5px}@media only screen and (max-width: 480px){.c-blog-tags{padding:15px}.c-blog-tags h1{font-size:27px}.c-blog-tags h2{font-size:16px;margin:15px 0}.c-tag__list{padding:0 0 30px;margin:30px 0 0}.c-tag__item{margin-bottom:5px}.c-tag__image{display:none}}.c-header{position:relative;width:100%;margin:20px 0}.c-header__box{position:relative;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.c-header__box .icon--ei-search{position:absolute;top:7px;left:15px;fill:#ccc}.c-search{width:80%}.c-search .c-search__box{display:flex;align-items:center}.c-search .c-search__text{position:relative;width:100%;padding:10px 10px 10px 40px;border:1px solid #dce4ea;border-radius:30px;outline:none;color:#a0a0a0}.c-search .c-search__text::placeholder{color:#ccc}.c-search .c-search__text:hover{box-shadow:0 1px 0px rgba(132,135,138,.1);transition:.35s}.c-search .c-search-results-list{position:absolute;width:100%;margin:10px 0 0;list-style-type:none;background-color:#fff;z-index:1}.c-search .c-search-results-list li{display:flex;flex-wrap:wrap;align-items:center;margin:0;padding:20px 25px 0;background-color:#fff;line-height:1.4;border-left:solid 1px #edeeee;border-right:solid 1px #edeeee}.c-search .c-search-results-list li:first-child{border-top-left-radius:5px;border-top-right-radius:5px;border-top:solid 1px #edeeee}.c-search .c-search-results-list li:last-child{border-bottom-left-radius:5px;border-bottom-right-radius:5px;padding-bottom:25px;border-bottom:solid 1px #edeeee}.c-search .c-search-results-list li a{font-size:16px}.c-nav{flex-grow:1;padding-left:20px}.c-nav .c-nav__list{display:flex;justify-content:flex-end}.c-nav .c-nav__list .c-nav__item{display:flex;align-items:center;float:left;padding:4px 10px;font-size:10px;text-transform:uppercase;white-space:nowrap;border:1px solid #dce4ea;box-shadow:0 1px 0px rgba(132,135,138,.4);will-change:transform;transform:translateY(0px);cursor:pointer}.c-nav .c-nav__list .c-nav__item:hover{color:#222;background-color:#fff}.c-nav .c-nav__list .c-nav__item.is-active{box-shadow:0 0 0 rgba(132,135,138,.5);transform:translateY(1px);color:#cfcfdd}.c-nav .c-nav__list .c-nav__item.is-active:hover{background-color:#fbfbfb}.c-nav .c-nav__list .c-nav__item:first-child{border-radius:10px 0 0 10px}.c-nav .c-nav__list .c-nav__item:last-child{border-radius:0 10px 10px 0}.c-nav .c-nav__list .c-nav__item .icon{width:18px;height:18px;margin-right:3px}@media only screen and (max-width: 900px){.c-header{margin:15px 0}}@media only screen and (max-width: 480px){.c-header .c-header__box{flex-direction:column}.c-header .c-search{width:100%}.c-header .c-search .c-search__text{padding:8px 8px 8px 40px}.c-header .c-nav{margin-top:15px}.c-header .c-nav .c-nav__list{justify-content:center}.c-header .c-nav .c-nav__item{padding:4px 8px}}.c-categories{width:100%}.c-categories__list{width:100%;display:flex;flex-direction:row;flex-wrap:wrap}.c-categories__item{max-width:25%;flex-basis:25%;padding:0 10px 20px}.c-categories__link{height:100%;display:flex;flex-direction:column;align-items:center;padding:20px 10px;border-radius:5px;box-shadow:5px 5px 25px rgba(46,61,73,.15);background-color:#fff;transition:.35s}.c-categories__link:hover{box-shadow:2px 4px 8px 0px rgba(46,61,73,.2)}.c-categories__link:hover .c-categories__img .c-categories__more{opacity:1;transition:.35s}.c-categories__link .c-categories__container{width:100%;word-wrap:break-word}.c-categories__link .c-categories__container.c-empty-figure{display:flex;flex-direction:column;justify-content:center;flex-grow:1}.c-categories__img{position:relative;max-width:100%}.c-categories__img figure{position:relative;width:200px;max-width:100%;margin-bottom:20px;overflow:hidden;background-size:cover;background-repeat:no-repeat;background-position:center;border-radius:50%;box-shadow:inset 0 1px 3px rgba(141,165,185,.3)}.c-categories__img figure:after{content:"";display:block;padding-top:100%}.c-categories__img figure:before{content:"";position:absolute;top:0;bottom:0;left:0;right:0;background-color:rgba(0,0,0,.15)}.c-categories__img .c-categories__more{display:inline-block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);font-weight:700;color:#fff;text-transform:uppercase;text-shadow:0 1px 0 rgba(104,172,191,.3);opacity:0;transition:.35s}.c-categories__container{text-align:center}.c-categories__container .c-categories__header{font-size:13px;margin-bottom:10px;font-weight:normal;text-transform:uppercase;color:#404040}.c-categories__container .c-categories__count{font-family:"Volkhov",serif;font-size:12px;color:#404040;margin-bottom:0}.c-categories__container .c-categories__count span{display:inline-block;width:20px;height:20px;line-height:20px;vertical-align:baseline;margin-right:5px;border-radius:50%;color:#fff;background-color:#ee6c6c}@media only screen and (max-width: 1200px){.c-categories .c-categories__item{max-width:33.333%;flex-basis:33.333%}}@media only screen and (max-width: 1050px){.c-categories .c-categories__item{max-width:50%;flex-basis:50%}}@media only screen and (max-width: 480px){.c-categories .c-categories__item{max-width:100%;flex-basis:100%;padding:0 0 20px}}.c-form-box{position:absolute;top:0;width:calc(100% - 40px);min-height:100vh;padding:0 20px;background-color:#fff;z-index:1}.c-form-bnt__close{position:absolute;top:0px;left:0;width:30px;height:30px;cursor:pointer;transition:.35s}.c-form-bnt__close:hover{transform:scale(0.8);opacity:.8}.c-form{position:relative;width:750px;max-width:100%;margin:40px auto}.c-form .c-form__title{margin:0 0 40px;min-width:0;border:0;padding:0;font-family:"Volkhov","Times New Roman",Times,serif;text-transform:uppercase;text-align:center}.c-form a{color:#404040}.c-form__group{margin-bottom:20px}.c-form__group label{display:block;text-transform:uppercase;font-size:10px}.c-form__group input,.c-form__group textarea{width:100%;padding:10px 15px;color:#404040;border:1px solid #dce4ea;outline:none;transition:.35s}.c-form__group input:focus,.c-form__group textarea:focus{box-shadow:0 4px 25px rgba(132,135,138,.1)}.c-form__group button{padding:20px;text-transform:uppercase;outline:none;border:none}.c-thank-you p{position:relative;padding:20px 40px;width:750px;max-width:100%;text-transform:uppercase;font-size:12px;line-height:18px;font-weight:700;margin:40px auto 0;text-align:center;color:#fff;background:linear-gradient(135deg, #55b5ad 0%, #5ec9c5 100%)}.c-thank-you p .c-form-bnt__close{width:25px;height:25px;background:rgba(0,0,0,0)}.c-thank-you p a{color:#fff}@media only screen and (max-width: 900px){.c-form-box{width:100%;left:0;right:0}}@media only screen and (max-width: 480px){.c-form-bnt__close{width:25px;height:25px}}.c-newsletter{padding:30px 0 60px;margin:0 auto;border-bottom:1px solid #f0f0f0}.c-newsletter__header{text-align:center}.c-newsletter__header .c-newsletter__title{font-size:14px;text-transform:uppercase;text-align:center}.c-newsletter__header .c-newsletter__subtitle{margin-bottom:15px}.c-newsletter-form{width:100%;max-width:750px;margin:0 auto}.c-newsletter-form .c-newsletter-form__group{display:flex}.c-newsletter__email{width:70%;height:40px;padding:10px 15px;border:1px solid #ddd;border-right-color:rgba(0,0,0,0);outline:none;transition:.35s}.c-newsletter__email:focus{box-shadow:0 4px 25px rgba(132,135,138,.1)}.c-newsletter__button{width:30%;height:40px;color:#fff;background-color:#3af;transition:.35s;border:none;outline:none;cursor:pointer}.c-newsletter__button:hover{background-color:#0086e6}@media only screen and (max-width: 480px){.c-newsletter__button{font-size:13px}}.c-comments{padding:30px 0;border-top:1px solid #f0f0f0}.c-top{position:fixed;width:40px;height:40px;bottom:20px;color:#757575;cursor:pointer;transition:.35s;right:-100px;z-index:10;opacity:.5}.c-top--active{right:15px}.c-top:hover{color:#757575;opacity:1}.u-text-left{text-align:left}.u-text-right{text-align:right}.u-text-center{text-align:center}.u-text-justify{text-align:justify}.u-block{display:block}.u-inline-block{display:inline-block}.u-inline{display:inline}.u-full-width{display:block;width:100%}.u-vertical-center{display:flex;align-items:center;justify-content:center}.u-responsive-image{max-width:100%;height:auto;vertical-align:middle}.u-show{display:block !important}.u-hide{display:none !important}.u-invisible{visibility:hidden}.u-float-left{float:left}.u-float-right{float:right}.u-no-padding-top{padding-top:0}.u-no-padding-bottom{padding-bottom:0}.u-no-padding-left{padding-left:0}.u-no-padding-right{padding-right:0}.u-no-padding{padding:0}.u-no-margin-top{margin-top:0}.u-no-margin-bottom{margin-bottom:0}.u-no-margin-left{margin-left:0}.u-no-margin-right{margin-right:0}.u-no-margin{margin:0}.u-lists-reset{list-style-type:none;margin:0;padding:0}.u-clearfix::before,.u-clearfix::after{content:"";display:table;clear:both}.u-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}
  </style>
</head>

<body>
  
  <div class="o-wrapper">
    <aside class="c-sidebar">
  <div class="c-sidebar-author">
    <div class="c-author__cover">
      <a href="/">
        <img src="/images/1.jpg" alt="María Alloza">
      </a>
    </div>
    <div class="c-author__info">
      <div class="c-author__name">María Alloza</div>
      <span class="c-author__job">DevOps Engineer</span>
    </div>
    <div class="c-contact-menu">
      
      <a href="/contact" class="c-contact-btn c-btn c-btn--secondary c-btn--round c-btn--shadow"><span data-icon='ei-envelope' data-size='s'></span> Send me</a>
      
      
      <a href="https://twitter.com/intent/user?screen_name=marixusa" class="c-btn c-btn--primary c-btn--round c-btn--shadow"><span data-icon='ei-sc-twitter' data-size='s'></span> Sígueme</a>
      
    </div>
    <p class="c-author__about">Soy Administradora de Sistemas en camino a convertirme en DevOps Engineer. Siempre con ganas de aprender y compartir.</p>
  </div>

  <div class="c-sidebar-footer">
    <div class="c-social">
      <div class="c-social__title">Social</div>
      <ul class="c-social__list u-lists-reset">
        
          <li class="c-social__item"><a href="https://twitter.com/marixusa" target="_blank"><div data-icon='ei-sc-twitter' data-size='s'></div></a></li>
        
        
        
        
          <li class="c-social__item"><a href="https://github.com/Legnakra" target="_blank"><div data-icon='ei-sc-github' data-size='s'></div></a></li>
        
        
        
        
        
        
        
        
        
        
          <li class="c-social__item"><a href="https://in.linkedin.com/in/www.linkedin.com/in/mariajesusalloza" target="_blank"><div data-icon='ei-sc-linkedin' data-size='s'></div></a></li>
        
      </ul>
    </div>
    <div class="c-copyright">
      <p>2023 &copy; María Alloza</p>
    </div>
  </div>
</aside> <!-- /.c-sidebar -->

<main class="c-content">
  <article class="c-article">
  <div class="c-article__content">
    <header class="c-header u-hide u-no-margin-top">
      <div class="c-header__box">
        <div class="c-search u-full-width">
          <div class="c-search__box">
            <label for="js-search-input" class="u-screen-reader-text">Search for Blog</label>
            <input type="text" id="js-search-input" class="c-search__text" autocomplete="off" placeholder="Type to search...">
            <div data-icon='ei-search' data-size='s'></div>
          </div>
          <ul id="js-results-container" class="c-search-results-list"></ul>
        </div>
      </div>
    </header>
    
    <div class="c-article__image o-opacity" style="background-image: url( /images/dns.png )"></div>
    
    <div class="c-wrap-content">
      <header class="c-article__header">
        <h1 class="c-article__title">Talleres DNS</h1>
        <div class="c-article__date">
          <span>2022, Dec 12</span>
        </div>
      </header>
      <h2 id="talleres-dns">Talleres DNS</h2>

<h3 id="taller-1-instalación-y-configuración-del-servidor-bind9-en-nuestra-red-local">Taller 1: Instalación y configuración del servidor bind9 en nuestra red local.</h3>

<ul>
  <li>Creamos una máquina en Proxmox configurada con cloud init e instalamos bind9.</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    apt <span class="nb">install </span>bind9
    </code></pre></figure>

<ul>
  <li>
    <p>Realizamos la siguiente configuración para que funcione como servidor.</p>
  </li>
  <li>
    <p>En el fichero <code class="language-plaintext highlighter-rouge">/etc/default/named/</code> modificamos el fichero con la siguiente línea:</p>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    <span class="nv">OPTIONS</span><span class="o">=</span><span class="s2">"-4 -f -u bind"</span>
    </code></pre></figure>

<ul>
  <li>Además, debemos tener en cuenta que solo se permitirán consultas desde la red local. En caso de realizarlo con una VPNm debemos modificar el fichero <code class="language-plaintext highlighter-rouge">/etc/bind/named.conf.options</code></li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    allow-query <span class="o">{</span>172.29.0.0/16<span class="p">;</span> 172.22.0.0/16<span class="p">;</span><span class="o">}</span><span class="p">;</span>
    </code></pre></figure>

<ul>
  <li>Reiniciamos el servidor y realizamos la siguiente consulta desde nuestro pc:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    dig @172.22.7.159 www.josedomingo.org
    </code></pre></figure>

<p><img src="/images/dns/1.png" alt="1" /></p>

<ul>
  <li>¿Cuánto ha tardado en realizar la consulta?
    <ul>
      <li>367 msec</li>
    </ul>
  </li>
  <li>¿Qué consultas se han realizado para averiguar la dirección IP?
    <ul>
      <li>La consulta es de tipo A y se ha realizado a la zona directa de josedomingo.org.</li>
    </ul>
  </li>
  <li>Realizamos de nuevo la consulta. ¿Cuánto ha tardado ahora?
    <ul>
      <li>0 msec</li>
    </ul>
  </li>
</ul>

<p><img src="/images/dns/2.png" alt="2" /></p>

<ul>
  <li>¿Por qué ha tardado menos?
    <ul>
      <li>Porque ya se ha realizado la consulta anteriormente y se ha guardado en el caché.</li>
    </ul>
  </li>
  <li>¿Qué consultas se han realizado para averiguar la dirección IP?
    <ul>
      <li>La consulta es de tipo A y se ha realizado a la zona directa de josedomingo.org.</li>
    </ul>
  </li>
  <li>Creamos una zona directa para nuestro dominio <code class="language-plaintext highlighter-rouge">maria.org</code>, añadiendo al fichero <code class="language-plaintext highlighter-rouge">/etc/bind/named.conf.local</code>:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    zone <span class="s2">"maria.org"</span> <span class="o">{</span>
    <span class="nb">type </span>master<span class="p">;</span>
    file <span class="s2">"db.maria.org"</span><span class="p">;</span>
    <span class="o">}</span><span class="p">;</span>
    </code></pre></figure>

<p><img src="/images/dns/3.png" alt="3" /></p>

<ul>
  <li>Creamos el fichero de la zona <code class="language-plaintext highlighter-rouge">/var/cache/bind/db.maria.org</code> y el fichero quedaría de la siguiente manera:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    <span class="nv">$TTL</span>    86400
    @       IN      SOA     dns1.maria.org. root.maria.org. <span class="o">(</span>
                                   1         <span class="p">;</span> Serial
                              604800         <span class="p">;</span> Refresh
                               86400         <span class="p">;</span> Retry
                             2419200         <span class="p">;</span> Expire
                               86400 <span class="o">)</span>       <span class="p">;</span> Negative Cache TTL
    <span class="p">;</span>
    @	IN	NS		dns1.maria.org.
    @	IN	MX	10	correo.maria.org.

    <span class="nv">$ORIGIN</span> maria.org.

    dns1			IN	A	172.22.7.159
    correo			IN	A	172.22.200.101
    asterix		    IN	A	172.22.200.102
    obelix			IN	A	172.22.200.103
    www			    IN	CNAME	asterix
    informatica		IN	CNAME	asterix
    ftp			    IN	CNAME	obelix
    </code></pre></figure>

<p><img src="/images/dns/4.png" alt="4" /></p>

<ul>
  <li>Creamos una zona inversa:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    zone <span class="s2">"22.172.in-addr.arpa"</span> <span class="o">{</span>
    <span class="nb">type </span>master<span class="p">;</span>
    file <span class="s2">"db.172.22.0.0"</span><span class="p">;</span>
    <span class="o">}</span><span class="p">;</span>
    </code></pre></figure>

<p><img src="/images/dns/7.png" alt="7" /></p>

<p>Y descomentamos la línea <code class="language-plaintext highlighter-rouge">include "/etc/bind/zones.rfc1918";</code> para así incluir todas las zonas correspondientes a las redes privadas para que no se pregunten por ellas al servidor DNS raíz.</p>

<p><img src="/images/dns/5.png" alt="5" /></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    ...
    zone <span class="s2">"21.172.in-addr.arpa"</span>  <span class="o">{</span> <span class="nb">type </span>master<span class="p">;</span> file <span class="s2">"/etc/bind/db.empty"</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span>
    //zone <span class="s2">"22.172.in-addr.arpa"</span>  <span class="o">{</span> <span class="nb">type </span>master<span class="p">;</span> file <span class="s2">"/etc/bind/db.empty"</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span>
    zone <span class="s2">"23.172.in-addr.arpa"</span>  <span class="o">{</span> <span class="nb">type </span>master<span class="p">;</span> file <span class="s2">"/etc/bind/db.empty"</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span>
    ...
    </code></pre></figure>

<p><img src="/images/dns/6.png" alt="6" /></p>

<ul>
  <li>Creamos el fichero <code class="language-plaintext highlighter-rouge">/var/cache/bind/db.172.22.0.0</code>:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    <span class="nv">$TTL</span>    86400
    @       IN      SOA     dns1.maria.org. root.maria.org. <span class="o">(</span>
                                    1         <span class="p">;</span> Serial
                                604800        <span class="p">;</span> Refresh
                                86400         <span class="p">;</span> Retry
                                2419200       <span class="p">;</span> Expire
                                86400 <span class="o">)</span>       <span class="p">;</span> Negative Cache TTL
    <span class="p">;</span>
    @	IN  NS      dns1.maria.org.

    <span class="nv">$ORIGIN</span> 22.172.in-addr.arpa.

    159.7		IN	PTR		dns1.maria.org.
    101.200		IN	PTR		correo.maria.org.
    102.200		IN 	PTR		asterix.maria.org.
    103.200		IN 	PTR		obelix.maria.org.
    </code></pre></figure>

<p><img src="/images/dns/7.png" alt="7" /></p>

<ul>
  <li>
    <p>Reiniciamos el servicio. Y configuramos el nuevo DNS en otra máquina, desde la que vamos a realizar las siguentes consultas con dig.</p>
  </li>
  <li>
    <p>Incluimos en el fichero <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> la IP del servidor DNS:</p>
  </li>
</ul>

<p><img src="/images/dns/8.png" alt="8" /></p>

<ul>
  <li>Dirección IP de una máquina o servicio.</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">        dig www.maria.org
        </code></pre></figure>

<p><img src="/images/dns/9.png" alt="9" /></p>

<ul>
  <li>Servidor DNS con autoridad de dominio:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">        dig ns www.maria.org
        </code></pre></figure>

<p><img src="/images/dns/10.png" alt="10" /></p>

<ul>
  <li>Servidor de correo del dominio.</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">        dig mx maria.org
        </code></pre></figure>

<p><img src="/images/dns/11.png" alt="11" /></p>

<ul>
  <li>Una resolución inversa.</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">        dig <span class="nt">-x</span> 172.22.200.103
        </code></pre></figure>

<p><img src="/images/dns/12.png" alt="12" /></p>

<h3 id="taller-2-instalación-y-configuración-de-un-servidor-dns-esclavo">Taller 2: Instalación y configuración de un servidor DNS esclavo.</h3>

<p>Un servidor DNS esclavo contiene una réplica de las zonas del servidor maestro. Se debe producir una transferencia de zona (el esclavo hace una solicitud de la zona completa al maestro) para que se sincronicen los servidores.</p>

<p>Antes que nada, cabe decir que el número de serie de la zona de transferencia tiene como función decirle al esclavo si la zona ha cambiado o no. Si el número de serie del esclavo es menor que el del maestro, el esclavo solicitará la zona al maestro. Si el número de serie del esclavo es mayor que el del maestro, el esclavo no solicitará la zona al maestro.</p>

<p>Los diferentes tiempos que se configuran enel registro <code class="language-plaintext highlighter-rouge">SOA</code> son:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Refresh</code>: Tiempo que debe pasar antes de que el esclavo vuelva a consultar al maestro si la zona ha cambiado.</li>
  <li><code class="language-plaintext highlighter-rouge">Retry</code>: Tiempo que debe pasar antes de que el esclavo vuelva a consultar al maestro si la zona no ha cambiado.</li>
  <li><code class="language-plaintext highlighter-rouge">Expire</code>: Tiempo que debe pasar antes de que el esclavo considere que la zona ha expirado y la borre.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Negative Cache TTL</code>: Tiempo que debe pasar antes de que el esclavo considere que la zona ha expirado.</p>
  </li>
  <li>Creamos otra máquina en Proxmox cuyo rol será de Servidor DNS esclavo, al que le instalaremos bind9 y lo nombraremos con el nombre <code class="language-plaintext highlighter-rouge">dns2.maria.org</code>. La transferencia de zona entre maestro y esclavo usará el puerto 53/tcp, que abriremos en el grupo de seguridad.</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    <span class="nb">sudo </span>ufw allow 53/tcp
    </code></pre></figure>

<ul>
  <li>Solo deberemos aceptar las transferencias de zonas hacia los esclavos autorizados, que lo haremos en el fichero <code class="language-plaintext highlighter-rouge">/etc/bind/named.conf.options</code>:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    options <span class="o">{</span>
    ...
    allow-transfer <span class="o">{</span> none<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
    ...
    <span class="o">}</span>
    </code></pre></figure>

<p><img src="/images/dns/13.png" alt="13" /></p>

<ul>
  <li>Modificamos el fichero <code class="language-plaintext highlighter-rouge">/etc/bind/named.conf.local</code> para definir la zona del DNS maestro:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    include <span class="s2">"/etc/bind/zones.rfc1918"</span><span class="p">;</span>
    zone <span class="s2">"maria.org"</span> <span class="o">{</span>
        <span class="nb">type </span>master<span class="p">;</span>
        file <span class="s2">"db.maria.org"</span><span class="p">;</span>
        allow-transfer <span class="o">{</span> 172.22.6.208<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
        notify <span class="nb">yes</span><span class="p">;</span>
    <span class="o">}</span><span class="p">;</span>
    zone <span class="s2">"22.172.in-addr.arpa"</span> <span class="o">{</span>
        <span class="nb">type </span>master<span class="p">;</span>
        file <span class="s2">"db.172.22.0.0"</span><span class="p">;</span>
        allow-transfer <span class="o">{</span> 172.22.6.208<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
        notify <span class="nb">yes</span><span class="p">;</span>
    <span class="o">}</span><span class="p">;</span>
    </code></pre></figure>

<p><img src="/images/dns/14.png" alt="14" /></p>

<ul>
  <li>Modificamos el fichero <code class="language-plaintext highlighter-rouge">/etc/bind/named.conf.local</code> para definir la zona del DNS esclavo:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    include <span class="s2">"/etc/bind/zones.rfc1918"</span><span class="p">;</span>
    zone <span class="s2">"maria.org"</span> <span class="o">{</span>
        <span class="nb">type </span>slave<span class="p">;</span>
        file <span class="s2">"db.maria.org"</span><span class="p">;</span>
        masters <span class="o">{</span> 172.22.6.208<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
    <span class="o">}</span><span class="p">;</span>
    zone <span class="s2">"22.172.in-addr.arpa"</span> <span class="o">{</span>
        <span class="nb">type </span>slave<span class="p">;</span>
        file <span class="s2">"db.172.22.0.0"</span><span class="p">;</span>
        masters <span class="o">{</span> 172.22.6.208<span class="p">;</span> <span class="o">}</span><span class="p">;</span>
    <span class="o">}</span><span class="p">;</span>
    </code></pre></figure>

<p><img src="/images/dns/15.png" alt="15" /></p>

<ul>
  <li>Añadimos la información del DNS esclavo en las zonas. Añadimos un nuevo registro NS y su correspondiente registro <code class="language-plaintext highlighter-rouge">A</code> en el fichero <code class="language-plaintext highlighter-rouge">/var/cache/bind/db.maria.org</code>:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    <span class="nv">$TTL</span>    86400
    @       IN      SOA     dns1.maria.org. root.maria.org. <span class="o">(</span>
                                1         <span class="p">;</span> Serial
                            604800        <span class="p">;</span> Refresh
                            86400         <span class="p">;</span> Retry
                            2419200       <span class="p">;</span> Expire
                            86400 <span class="o">)</span>       <span class="p">;</span> Negative Cache TTL
    <span class="p">;</span>
    @	IN	NS		dns1.maria.org.
    @	IN	NS		dns2.maria.org.
    @	IN	MX	10	correo.maria.org.

    <span class="nv">$ORIGIN</span> maria.org.

    dns1		IN	A         172.22.7.159
    dns2		IN	A	10    172.22.6.208
    ...
    </code></pre></figure>

<p><img src="/images/dns/16.png" alt="16" /></p>

<p>Y modificamos el fichero <code class="language-plaintext highlighter-rouge">/var/cache/bind/db.172.22.0.0</code>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    <span class="nv">$TTL</span>    86400
    @       IN      SOA     dns1.maria.org. root.maria.org. <span class="o">(</span>
                                  1         <span class="p">;</span> Serial
                             604800         <span class="p">;</span> Refresh
                              86400         <span class="p">;</span> Retry
                            2419200         <span class="p">;</span> Expire
                              86400 <span class="o">)</span>       <span class="p">;</span> Negative Cache TTL
    <span class="p">;</span>
    @	IN	NS		dns1.maria.org.
    @	IN	NS		dns2.maria.org.  
    
    <span class="nv">$ORIGIN</span> 22.172.in-addr.arpa.    
    159.7		IN	PTR		dns1.maria.org.
    208.6		IN	PTR		dns2.maria.org.  
    ...
    </code></pre></figure>

<p><img src="/images/dns/17.png" alt="17" /></p>

<ul>
  <li>
    <p>Reiniciamos los servidores DNS, tanto el maestro como el esclavo.</p>
  </li>
  <li>
    <p>En caso de que nos salga algún error, probamos con los siguientes comandos:</p>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    named-checkzone maria.org /var/cache/bind/db.maria.org
    named-checkzone 22.172.in-addr.arpa /var/cache/bind/db.172.22.0.0  
    <span class="c">#Para detectar errores de configuración en `named.conf`, podemos usar:
</span>
    named-checkconf
    </code></pre></figure>

<ul>
  <li>
    <p>Configuramos el cliente con los dos servidores DNS. En el fichero <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> utiliza dos directivas <code class="language-plaintext highlighter-rouge">nameserver</code>. Si hacemos  una consulta desde un cliente, y el dns maestro no responde, responderá el esclavo. Prueba a realizar una consulta.</p>
  </li>
  <li>
    <p>¿Quién ha respondido?.</p>
    <ul>
      <li>Al realizar <code class="language-plaintext highlighter-rouge">dig www.maria.org</code> el servdor que responde es el maestro.</li>
    </ul>
  </li>
</ul>

<p>[<img src="/images/dns/18.png" alt="18" /></p>

<p>Apagamos el servidor maestro, y volvemos a hacer la misma consulta.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    <span class="nt">---Apagamos</span> el servicio de la máquina dns1
    <span class="nv">$ </span><span class="nb">sudo </span>systemctl stop bind9
    <span class="nt">---Hacemos</span> la consulta
    <span class="nv">$ </span>dig www.maria.org
    </code></pre></figure>

<ul>
  <li>¿Ha respondido el servidor DNS esclavo?
    <ul>
      <li>Al apagar el servidor maestro y realizar la consulta, el servidor que responde es el esclavo.</li>
    </ul>
  </li>
</ul>

<p>[<img src="/images/dns/19.png" alt="19" /></p>

<ul>
  <li>Modificamos la zona, y para ello lo modificamos en el servidor maestro en el fichero <code class="language-plaintext highlighter-rouge">/var/cache/bind/db.maria.org</code> añadiendo:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    ...
    prueba		IN  A   172.22.6.208
    ...
    </code></pre></figure>

<ul>
  <li>
    <p>Desde el cliente realizaremos una consulta para preguntar por la dirección IP de <code class="language-plaintext highlighter-rouge">prueba.maria.org</code>.</p>
  </li>
  <li>
    <p>¿Quién ha respondido?.</p>
    <ul>
      <li>Al realizar <code class="language-plaintext highlighter-rouge">dig prueba.maria.org</code> el servdor que responde es el maestro.</li>
    </ul>
  </li>
</ul>

<p>[<img src="/images/dns/20.png" alt="20" /></p>

<p>Apagamos el servidor maestro, y volvemos a hacer la misma consulta.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    <span class="nt">---Apagamos</span> el servicio de la máquina dns1
    <span class="nv">$ </span><span class="nb">sudo </span>systemctl stop bind9
    <span class="nt">---Hacemos</span> la consulta
    <span class="nv">$ </span>dig www.maria.org
    </code></pre></figure>

<ul>
  <li>¿Ha respondido el servidor DNS esclavo?
    <ul>
      <li>Al apagar el servidor maestro y realizar la consulta, el servidor que responde es el esclavo.</li>
    </ul>
  </li>
</ul>

<p>Comprobamos en el esclavo que se ha producido la transferencia.</p>

<p><img src="/images/dns/21.png" alt="21" /></p>

<ul>
  <li>
    <p><strong>EXTRA</strong>. Crea un registro nuevo en el maestro y regístrarlo en el esclavo.</p>

    <ul>
      <li>En el maestro añadimos el registro <code class="language-plaintext highlighter-rouge">prueba2</code> con la IP <code class="language-plaintext highlighter-rouge">172.22.7.169</code> en el fichero <code class="language-plaintext highlighter-rouge">/var/cache/bind/db.maria.org</code>:</li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    ...
    prueba2		IN  A   172.22.7.169
    ...
    </code></pre></figure>

<ul>
  <li>Modificamos el fichero <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> del host para realizar las pruebas.</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    ...
    nameserver 172.22.7.159
    nameserver 172.22.6.208
    ...
    </code></pre></figure>

<ul>
  <li>Hacemos la consulta desde el cliente para comprobar que se ha registrado correctamente y comprobamos que responde el servidor maestro.</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    dig prueba2.maria.org
    </code></pre></figure>

<p><img src="/images/dns/22.png" alt="22" /></p>

<ul>
  <li>Apagamos el servidor maestro y volvemos a hacer la consulta. En este caso, el servidor que responde es el esclavo.</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"> 
    <span class="nv">$ </span><span class="nb">sudo </span>systemctl stop bind9
    <span class="c">#Hacemos la consulta en el host
</span>
    <span class="nv">$ </span>dig prueba2.maria.org
    </code></pre></figure>

<p><img src="/images/dns/23.png" alt="23" /></p>

<h3 id="taller-3-delegación-de-subdominios-con-bind9">Taller 3: Delegación de subdominios con bind9</h3>

<ul>
  <li>Crea una nueva máquina e instala un servidor DNS bind9, será el servidor DNS con autoridad para la zona delegada que será <code class="language-plaintext highlighter-rouge">informatica.maria.org</code>. Nombra de manera adecuada esta máquina para que tenga el nombre <code class="language-plaintext highlighter-rouge">dns.informatica.maria.org</code>.
    <ul>
      <li>Tendremos el servidor <code class="language-plaintext highlighter-rouge">dns1.maria.org</code> (y el esclavo <code class="language-plaintext highlighter-rouge">dns2.maria.org</code>) con autoridad para la zona <code class="language-plaintext highlighter-rouge">maria.org</code>. En esta zona, por ejemplo, puede existir el nombre <code class="language-plaintext highlighter-rouge">www.maria.org</code>.</li>
      <li>Tendremos el servidor <code class="language-plaintext highlighter-rouge">dns.informatica.maria.org</code> con autoridad sobre el subdominio delegado, es decir tendrá autoridad para la zona <code class="language-plaintext highlighter-rouge">informatica.maria.org</code>. En esta zona, por ejemplo, puede existir el nombre <code class="language-plaintext highlighter-rouge">www.informatica.maria.org</code>.</li>
    </ul>
  </li>
  <li>Vamos a realizar la delegación de autoridad para el subdominio en el servidor DNS principal (en <code class="language-plaintext highlighter-rouge">dns1.maria.org</code>) para ello modificamos el fichero <code class="language-plaintext highlighter-rouge">/var/cache/bind/db.maria.org</code> añadiendo las siguientes líneas donde realizamos la delegación:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    ...
    <span class="nv">$ORIGIN</span> informatica.maria.org. 
    @		IN	 NS		dns
    dns 	IN	 A 		172.22.2.218
    ...
    </code></pre></figure>

<p><img src="/images/dns/24.png" alt="24" /></p>

<ul>
  <li>Ahora vamos a configurar el servidor DNS delegado. Por lo tanto en el servidor <code class="language-plaintext highlighter-rouge">dns.informatica.maria.org</code> creamos una nueva zona en el fichero <code class="language-plaintext highlighter-rouge">/etc/bind/named.conf.local</code>:</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">        zone <span class="s2">"informatica.maria.org"</span> <span class="o">{</span>
        <span class="nb">type </span>master<span class="p">;</span>
        file <span class="s2">"db.informatica.maria.org"</span><span class="p">;</span>
    <span class="o">}</span><span class="p">;</span>
    </code></pre></figure>

<p><img src="/images/dns/25.png" alt="25" /></p>

<p>Y creamos la zona en el fichero <code class="language-plaintext highlighter-rouge">/var/cache/bind/db.informatica.maria.org</code>:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    <span class="nv">$TTL</span>    86400
    @       IN      SOA     dns.informatica.maria.org. root.informatica.maria.org. <span class="o">(</span>
                                  1         <span class="p">;</span> Serial
                             604800         <span class="p">;</span> Refresh
                              86400         <span class="p">;</span> Retry
                            2419200         <span class="p">;</span> Expire
                              86400 <span class="o">)</span>       <span class="p">;</span> Negative Cache TTL
    <span class="p">;</span>
    @	IN	NS		dns.informatica.maria.org.
    @	IN	MX	10	mail.informatica.maria.org.
    <span class="nv">$ORIGIN</span> informatica.maria.org.
    dns			IN	A		172.22.2.218
    mail		IN	A		172.22.200.121 
    web			IN	A 		172.22.200.122
    www			IN 	CNAME 	web
    ...
    </code></pre></figure>

<p><img src="/images/dns/26.png" alt="26" /></p>

<ul>
  <li>No modifiques el fichero <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> del cliente, es decir, las consultas se hacen al servidor DNS principal, cuando preguntemos por un nombre en la zona delegada el servidor DNS principal, preguntará al servidor DNS delegado y guardara la respuesta en su caché. Pregunta por la dirección ip del nombre www.informatica.maria.org. 
  ¿Quién ha respondido?
    <ul>
      <li>El servidor DNS que ha respondido es el servidor maestro <code class="language-plaintext highlighter-rouge">dns1.maria.org</code> ya que es el que tiene la autoridad sobre la zona <code class="language-plaintext highlighter-rouge">maria.org</code>.</li>
    </ul>
  </li>
</ul>

<h4 id="comprobaciones-de-funcionamiento">Comprobaciones de funcionamiento</h4>

<ul>
  <li>Vamos a realizar una consulta para averiguar la dirección IP de <code class="language-plaintext highlighter-rouge">www.informatica.maria.org</code> desde el cliente sin modificar el fichero <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> del cliente.</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    dig www.informatica.maria.org
    </code></pre></figure>

<p><img src="/images/dns/27.png" alt="27" /></p>

<ul>
  <li>Realizamos una consulta para averiguar el servidor DNS con autoridad para la zona del dominio <code class="language-plaintext highlighter-rouge">informatica.maria.org</code>. ¿Es el mimso que el servidor DNS con autoridad para la zona del dominio <code class="language-plaintext highlighter-rouge">maria.org</code>?</li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">    dig ns wwwinformatica.maria.org
    </code></pre></figure>

<p><img src="/images/dns/28.png" alt="28" /></p>

<ul>
  <li>
    <p>El servidor DNS con autoridad para la zona del dominio <code class="language-plaintext highlighter-rouge">informatica.maria.org</code> es el servidor <code class="language-plaintext highlighter-rouge">dns.informatica.maria.org</code> y el servidor DNS con autoridad para la zona del dominio <code class="language-plaintext highlighter-rouge">maria.org</code> es el servidor <code class="language-plaintext highlighter-rouge">dns1.maria.org</code>.</p>
  </li>
  <li>
    <p>Realizamos una consulta para averiguar el servidor de correo confgurado para <code class="language-plaintext highlighter-rouge">informatica.maria.org</code>.</p>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">     dig mx informatica.maria.org
    </code></pre></figure>

<p><img src="/images/dns/29.png" alt="29" /></p>

      <div class="c-article__footer u-clearfix">
        <div class="c-article__tag">
          
          <a href="/tags#dns">&#35; dns</a>
          
          <a href="/tags#bind9">&#35; bind9</a>
          
        </div>
      </div>
      </div> <!-- /.c-recent-post -->
    </div> <!-- /.c-wrap-content -->
  </div> <!-- /.c-article__content -->
</article> <!-- /.c-article-page -->
</main> <!-- /.c-content -->

  </div> <!-- /.o-wrapper -->
  <div class="c-top" data-icon='ei-chevron-up' data-size='s' title="Scroll To Top"></div> <!-- /.c-top -->
  <script src="/js/jquery-3.3.1.min.js"></script>
<script src="/js/evil-icons.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
<script src="/js/simple-jekyll-search.min.js"></script>
<script src="/js/main.js"></script>
<!-- /javascripts -->
</body>
</html>