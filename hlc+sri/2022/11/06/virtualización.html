<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Virtualizaci贸n en Linux | sysmaria</title>
<meta name="generator" content="Jekyll v4.2.2">
<meta property="og:title" content="Virtualizaci贸n en Linux">
<meta property="og:locale" content="en_US">
<meta name="description" content="Virtualizaci贸n">
<meta property="og:description" content="Virtualizaci贸n">
<link rel="canonical" href="/hlc+sri/2022/11/06/virtualizaci%C3%B3n.html">
<meta property="og:url" content="/hlc+sri/2022/11/06/virtualizaci%C3%B3n.html">
<meta property="og:site_name" content="sysmaria">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-11-06T13:11:32+01:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Virtualizaci贸n en Linux">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-11-06T13:11:32+01:00","datePublished":"2022-11-06T13:11:32+01:00","description":"Virtualizaci贸n","headline":"Virtualizaci贸n en Linux","mainEntityOfPage":{"@type":"WebPage","@id":"/hlc+sri/2022/11/06/virtualizaci%C3%B3n.html"},"url":"/hlc+sri/2022/11/06/virtualizaci%C3%B3n.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="sysmaria">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
</head>
<body>



























































































































<header class="site-header site-header-transparent" role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="sysmaria" src="" onerror="this.style.display='none'">
  sysmaria
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/categories.html">CATEGORIAS</a>




</div>
        </nav>
</div>
  </div>
</header>

<script>
  function initHeader() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;documentElement.setAttribute("data-header-transparent", "");var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  }
  document.addEventListener('DOMContentLoaded', initHeader);
</script>
















































































































































<section class="page-banner">
    <div class="page-banner-img">
<div style="background-image: url(/assets/images/banners/banner_computo.jpg)"></div>
        <img class="img-placeholder" src="/assets/images/banners/banner_computo.jpg">
</div>
    <div class="wrapper">
      <div class="page-banner-inner">
<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">Virtualizaci贸n en Linux</h1>
  <h2 class="post-subtitle"></h2>

  <p class="post-meta">
    <time class="dt-published" datetime="2022-11-06T13:11:32+01:00" itemprop="datePublished"><i class="fa fa-calendar"></i> Nov 6, 2022
    </time>

    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 6 mins</span>
  </p></header>
</div>
    </div>
  </section><script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    hashValue = decodeURIComponent(hashValue);
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<div id="click-to-top" class="click-to-top">
  <i class="fa fa-arrow-up"></i>
</div>
<script>
  (function () {
    const clickToTop = document.getElementById('click-to-top');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 100) {
        clickToTop.classList.add('show')
      }else {
        clickToTop.classList.remove('show')
      }
    });
    clickToTop.addEventListener('click', () => {
      window.smoothScrollTo(0);
    });
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <h1 id="virtualizaci贸n">Virtualizaci贸n</h1>

<ol>
  <li>驴Qu茅 es la virtualizaci贸n?
    <ul>
      <li>Nos permite ejecutar m谩s de un sistema virtual, y m煤ltiples sistemas operativos y aplicaciones, en un solo servidor, aumentando el rendimiento del hardware disponible e incrementando el tiempo de procesamiento de un equipo, ya que habitualmente se desaprovecha gran parte.</li>
    </ul>
  </li>
  <li>驴Para qu茅 se utiliza la virtualizaci贸n?
    <ul>
      <li>Aislamiento e independencia de servicios y contenidos.</li>
      <li>Laboratorio de pruebas.</li>
      <li>Virtualizaci贸n de arquitecturas de las que no se dispone.</li>
      <li>Creaci贸n de cl煤ster de m谩quinas y sistemas distribuidos.</li>
      <li>Herramientas de aprendizajes</li>
    </ul>
  </li>
  <li>Ventajas de la virtualizaci贸n:
    <ul>
      <li>Aumenta la seguridad.</li>
      <li>Reduce los costes.</li>
      <li>Mayor aprovechamiento de los recursos.</li>
      <li>Migraci贸n en vivo.</li>
      <li>Ahorro energ茅tico.</li>
    </ul>
  </li>
  <li>Desventajas de la virtualizaci贸n:
    <ul>
      <li>Rendimento.</li>
      <li>Muchos sistemas dependen de un solo equipo.</li>
    </ul>
  </li>
  <li>Conceptos de virtualizaci贸n
    <ul>
      <li>HOST: Es el equipo que ejecuta el sistema operativo y las aplicaciones.</li>
      <li>GUEST: Es el sistema operativo virtualizado.</li>
      <li>Hypervisor: Es el software que permite la virtualizaci贸n.</li>
    </ul>
  </li>
  <li>Tipos de virtualizaci贸n
    <ul>
      <li>Emulaci贸n: imita la arquitectura de un sistema al completo. Rendimiento bajo. Ejemplo: QEMU.</li>
    </ul>
  </li>
</ol>

<ul>
  <li>
    <p>Virtualizaci贸n de hardware: simula un hardware suficiente para permitir que un sistema operativo se ejecute de forma aislada. Rendimiento medio. Hipervisor de tipo 1. Ejemplo: VMware.</p>
  </li>
  <li>
    <p>Virtualizaci贸n completa: El hipervisor simula un hardware suficiente para permitir que un sistema operativo no adaptado se ejecute de forma aislada. HyperVisor de tipo 2. Ejemplo: VirtualBox.</p>
  </li>
  <li>
    <p>Virtualizaci贸n parcial: El hipervisor ofrece un interfaz especial para acceder a los recursos. Ejemplo: Xen.</p>
  </li>
  <li>
    <p>Virtualizaci贸n ligera: tambi茅n llamada virtualizaci贸n basada en contenedores. Sobre el n煤cleo del sistema operativo se ejecuta una capa de virtualizaci贸n que permite que existan m煤ltiples instancias aisladas de espacios de usuario (contenedor). Ejemplo: Docker.</p>
    <ul>
      <li>Tipos:
        <ul>
          <li>Contenedores de Sistemas: El uso que se hace de ellos es muy similar al que hacemos sobre una m谩quina virtual: se accede a ellos (normalmente por ssh), se instalan servicios, se actualizan, ejecutan un conjunto de procesos, . . . Ejemplo: LXC(Linux Container).</li>
          <li>Contenedores de Aplicaci贸n: Se suelen usar para el despliegue de aplicaciones web Ejemplo: Docker, Podman, . . .</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<ol>
  <li>驴Qu茅 es un QEMU?
    <ul>
      <li>Es un emulador gen茅rico y de c贸digo abierto de m谩quinas virtuales, permitiendo ejecutar sistemas operativos de una determinada arquitectura en una m谩quina con otra arquitectura distinta.</li>
    </ul>
  </li>
  <li>驴Que es KVM?
    <ul>
      <li>Es un hipervisor de tipo 1 que permite la virtualizaci贸n de hardware completo. Es un m贸dulo del n煤cleo de Linux que que contienen las extensiones de virtualizaci贸n Intel VT o AMD-V.</li>
    </ul>
  </li>
  <li>驴Qu茅 es un Libvirt?
    <ul>
      <li>Es una biblioteca de software que proporciona una API para la gesti贸n de m谩quinas virtuales, redes, almacenamiento, etc. Es una capa de abstracci贸n que permite la gesti贸n de m谩quinas virtuales independientemente del hipervisor que se utilice.</li>
    </ul>
  </li>
  <li>Mecanismos de conexi贸n a Libvirto
    <ul>
      <li>Local no provolegiado: Se conecta a trav茅s de un socket Unix. <em>qemu:///session</em>
</li>
      <li>Remoto: Se conecta a trav茅s de un socket Unix. <em>qemu+ssh://user@host/system</em>
</li>
      <li>Acceso local privilegiado: Se acceden a las m谩quinas virtuales del sistema. <em>qemu:///session</em>
</li>
    </ul>
  </li>
  <li>Aplicaciones para usar Libvirt
    <ul>
      <li>virsh: Interfaz de l铆nea de comandos. <em>virsh -c qemu:///session</em>
</li>
      <li>virt-manager: Es una interfaz gr谩fica para la gesti贸n de m谩quinas virtuales. <em>virt-manager -c qemu:///session</em>
</li>
      <li>virtinst: Es una herramienta para la creaci贸n de m谩quinas virtuales. <em>virt-install -c qemu:///session</em>
</li>
      <li>virt-viewer: Es una herramienta para la gesti贸n de m谩quinas virtuales. <em>virt-viewer -c qemu:///session</em>
</li>
      <li>gnome-boxes: Es una herramienta para la gesti贸n de m谩quinas virtuales. <em>gnome-boxes -c qemu:///session</em>
</li>
    </ul>
  </li>
  <li>驴Qu茅 es LXC?
    <ul>
      <li>Es un sistema de contenedores de Linux que permite la creaci贸n y gesti贸n de contenedores de Linux. Es un sistema de virtualizaci贸n ligera que permite la creaci贸n de contenedores de Linux.</li>
    </ul>
  </li>
  <li>驴Qu茅 componentes tiene LXC?
    <ul>
      <li>Grupos de control de cgroups: Es un subsistema del n煤cleo de Linux que permite la gesti贸n de recursos de un grupo de procesos.</li>
      <li>Espacio de nombres namespaces que proporcionan un punto de vista diferente a un proceso (interfaces de red, procesos, usuarios, etc.).</li>
    </ul>
  </li>
  <li>驴A qu茅 pertenecen los contenedores de LXC?
    <ul>
      <li>A los contenedores de sistemas. Su gesti贸n y ciclo de vida es similar al de una m谩quina virtual tradicional. Est谩 mantenido por Canonical y
la p谩gina oficial es linuxcontainers.org.</li>
    </ul>
  </li>
  <li>驴Qu茅 es LXD?
    <ul>
      <li>Es una herramienta de gesti贸n de los contenedores y m谩quinas virtuales del sistema operativo Linux, desarrollada por Canonical.</li>
    </ul>
  </li>
</ol>

<h2 id="comandos">COMANDOS</h2>

<ol>
  <li>Comandos de virsh
    <ul>
      <li>virsh list: Lista las m谩quinas virtuales.</li>
      <li>virsh list all: Lista todas las m谩quinas virtuales.</li>
      <li>virsh start <nombre>: Inicia una m谩quina virtual.</nombre>
</li>
      <li>virsh shutdown <nombre>: Apaga una m谩quina virtual.</nombre>
</li>
      <li>virsh destroy <nombre>: Apaga una m谩quina virtual.</nombre>
</li>
      <li>virsh undefine <nombre>: Elimina una m谩quina virtual.</nombre>
</li>
      <li>virsh define <nombre>: Crea una m谩quina virtual.</nombre>
</li>
      <li>virsh edit <nombre>: Edita una m谩quina virtual.</nombre>
</li>
      <li>virsh domifaddr <nombre>: Muestra la direcci贸n IP de una m谩quina virtual.</nombre>
</li>
      <li>virsh domiflist <nombre>: Muestra las interfaces de red de una m谩quina virtual.</nombre>
</li>
      <li>virsh dominfo <nombre>: Muestra informaci贸n de una m谩quina virtual.</nombre>
</li>
      <li>virsh domxml <nombre>: Muestra el XML de una m谩quina virtual.</nombre>
</li>
      <li>virsh dumpxml <nombre>: Muestra el XML de una m谩quina virtual.</nombre>
</li>
      <li>virsh net-list: Lista las redes virtuales.</li>
      <li>virsh net-start <nombre>: Inicia una red virtual.</nombre>
</li>
      <li>virsh net-destroy <nombre>: Apaga una red virtual.</nombre>
</li>
      <li>virsh net-undefine <nombre>: Elimina una red virtual.</nombre>
</li>
      <li>virsh net-define <nombre>: Crea una red virtual.</nombre>
</li>
      <li>virsh net-edit <nombre>: Edita una red virtual.</nombre>
</li>
      <li>virsh net-dumpxml <nombre>: Muestra el XML de una red virtual.</nombre>
</li>
      <li>virsh net-info <nombre>: Muestra informaci贸n de una red virtual.</nombre>
</li>
      <li>virsh net-autostart <nombre>: Inicia una red virtual al arrancar el sistema.</nombre>
</li>
      <li>virsh net-autostart disable <nombre>: No inicia una red virtual al arrancar el sistema.</nombre>
</li>
    </ul>
  </li>
  <li>Comandos de virt-manager
    <ul>
      <li>virt-manager: Inicia la interfaz gr谩fica de gesti贸n de m谩quinas virtuales.</li>
      <li>virt-install: Crea una m谩quina virtual.</li>
      <li>virt-viewer: Gestiona una m谩quina virtual.</li>
    </ul>
  </li>
  <li>Comandos de LXC
    <ul>
      <li>lxc-list: Lista los contenedores.</li>
      <li>lxc-start: Inicia un contenedor.</li>
      <li>lxc-stop: Apaga un contenedor.</li>
      <li>lxc-destroy: Elimina un contenedor.</li>
      <li>lxc-create: Crea un contenedor.</li>
      <li>lxc-attach: Accede a un contenedor.</li>
      <li>lxc-console: Accede a la consola de un contenedor.</li>
      <li>lxc-info: Muestra informaci贸n de un contenedor.</li>
    </ul>
  </li>
  <li>Comandos virt
    <ul>
      <li>virt-clone: Clona una m谩quina virtual.</li>
      <li>virt-install: Crea una m谩quina virtual.</li>
    </ul>
  </li>
</ol>


    </div>

</article>
<div class="post-nav">
<a class="previous" href="/aso/2022/10/12/compilacion-paquete-makefile.html" title="Compilar dos2unix partiendo del c贸digo fuente">Compilar dos2unix partiendo del c贸digo fuente...</a><a class="next" href="/python/2022/11/06/github.html" title="Introducci贸n a GitHub">Introducci贸n a GitHub</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/iaw/2023/01/27/docker-multicontenedor.html" title="Introducci贸n a GitHub">Taller Docker - Escenarios multicontenedor en Docker</a></li>
<li><a class="post-link" href="/asgdb/2022/11/08/interconexion.html" title="Introducci贸n a GitHub">Interconexiones de servidores</a></li>
<li><a class="post-link" href="/seguridad/2023/01/12/vpn-c.html" title="Introducci贸n a GitHub">VPN de acceso remoto con WireGuard (Windows, Linux, Android)</a></li>
<li><a class="post-link" href="/python/2022/11/06/github.html" title="Introducci贸n a GitHub">Introducci贸n a GitHub</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">MEN </div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
<div></div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="https://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>
</body>
</html>
